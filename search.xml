<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>openstack train 安装环境准备</title>
    <url>/2021/01/26/openstack-train-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</url>
    <content><![CDATA[<h1 id="服务器规划"><a href="#服务器规划" class="headerlink" title="服务器规划"></a>服务器规划</h1><p>本次测试环境采用3台DELL物理机进行安装部署，管理vlan 33,业务vlan 11,服务器业务网卡不配置ip地址,采用provider vlan网络(通俗来讲就是网关在物理设备上面)  </p>
<a id="more"></a>  

<table>
<thead>
<tr>
<th>管理IP</th>
<th>业务IP 段</th>
<th>硬件信息</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>10.14.32.11</td>
<td>10.14.11.0/24</td>
<td>2路*8core、4T、256G</td>
<td>控制节点、网络节点</td>
</tr>
<tr>
<td>10.14.32.12</td>
<td>10.14.11.0/24</td>
<td>2路*8core、4T、256G</td>
<td>计算节点</td>
</tr>
<tr>
<td>10.14.32.13</td>
<td>10.14.11.0/24</td>
<td>2路*8core、4T、256G</td>
<td>计算节点</td>
</tr>
</tbody></table>
<h1 id="软件规划"><a href="#软件规划" class="headerlink" title="软件规划"></a>软件规划</h1><table>
<thead>
<tr>
<th>操作系统版本</th>
<th>软件版本</th>
</tr>
</thead>
<tbody><tr>
<td>Centos7.6</td>
<td>openstack-train</td>
</tr>
</tbody></table>
<h1 id="主机名称配置"><a href="#主机名称配置" class="headerlink" title="主机名称配置"></a>主机名称配置</h1><p>控制节点  </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hostnamectl set-hostname bjyz-10-14-32-11</span><br></pre></td></tr></table></figure>
<p>计算节点  </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hostnamectl set-hostname bjyz-10-14-32-12</span><br><span class="line">hostnamectl set-hostname bjyz-10-14-32-13</span><br></pre></td></tr></table></figure>


<h1 id="时间服务器"><a href="#时间服务器" class="headerlink" title="时间服务器"></a>时间服务器</h1><p>控制节点从互联网同步时间，计算节点从控制节点同步时间，centos7 采用chrony进行时间同步  </p>
<ol>
<li><p>所有节点安装chrony软件  </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install chrony -y</span><br></pre></td></tr></table></figure>

</li>
<li><p>控制节点修改配置，本文只有允许两个网段可以同步时间</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat &gt;&gt;/etc/chrony.conf &lt;&lt;eof</span><br><span class="line">server ntp1.aliyun.com  iburst</span><br><span class="line">driftfile /var/lib/chrony/drift</span><br><span class="line">makestep 1.0 3</span><br><span class="line">rtcsync</span><br><span class="line">allow 10.14.32.0/24</span><br><span class="line">allow 10.14.11.0/24</span><br><span class="line">eof</span><br></pre></td></tr></table></figure></li>
<li><p>控制节点启动chronyd 服务</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl start chronyd</span><br></pre></td></tr></table></figure>
<p> 验证同步结果  </p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chronyc sources -v</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>
</code></pre>
</li>
</ol>
<p><img src="/images/openstack-train-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210129151301718.png" alt="image-20210129151301718"></p>
<ol start="4">
<li><p>计算节点配置chrony服务</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat &gt;&gt;/etc/chrony.conf&lt;&lt;eof</span><br><span class="line">server 10.14.32.11</span><br><span class="line">driftfile /var/lib/chrony/drift</span><br><span class="line">makestep 1.0 3</span><br><span class="line">rtcsync</span><br><span class="line">logdir /var/log/chrony</span><br><span class="line">eof</span><br></pre></td></tr></table></figure>
<p>计算节点启动chronyd服务并验证</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl start chronyd &amp;&amp; systemctl enable chronyd</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chronyc sources -v</span><br></pre></td></tr></table></figure>
<p><img src="/images/openstack-train-%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210129152910069.png" alt="image-20210129152910069"></p>
<h1 id="配置主机hosts"><a href="#配置主机hosts" class="headerlink" title="配置主机hosts"></a>配置主机hosts</h1><p>所有节点都要配置主机hosts文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat &gt;&gt;/etc/hosts&lt;&lt;eof</span><br><span class="line">10.14.32.11 controller</span><br><span class="line">10.14.32.11 bjyz-10-14-32-11</span><br><span class="line">10.14.32.12 bjyz-10-14-32-12</span><br><span class="line">10.14.32.13 bjyz-10-14-32-13</span><br><span class="line">eof</span><br></pre></td></tr></table></figure>




<h1 id="配置主机互信"><a href="#配置主机互信" class="headerlink" title="配置主机互信"></a>配置主机互信</h1><p>控制节点到计算节点免密登录,全部默认即可</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>
<p>拷贝公钥到计算节点</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for i in `seq 11 13`;do ssh-copy-id -i .ssh/id_rsa.pub 10.14.32.$i;done</span><br></pre></td></tr></table></figure>




<p>​    </p>
</li>
</ol>
]]></content>
      <categories>
        <category>openstack</category>
      </categories>
  </entry>
</search>
